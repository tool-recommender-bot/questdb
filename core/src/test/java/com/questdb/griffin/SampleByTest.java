/*******************************************************************************
 *    ___                  _   ____  ____
 *   / _ \ _   _  ___  ___| |_|  _ \| __ )
 *  | | | | | | |/ _ \/ __| __| | | |  _ \
 *  | |_| | |_| |  __/\__ \ |_| |_| | |_) |
 *   \__\_\\__,_|\___||___/\__|____/|____/
 *
 * Copyright (C) 2014-2018 Appsicle
 *
 * This program is free software: you can redistribute it and/or  modify
 * it under the terms of the GNU Affero General Public License, version 3,
 * as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 ******************************************************************************/

package com.questdb.griffin;

import com.questdb.griffin.engine.functions.rnd.SharedRandom;
import com.questdb.std.Rnd;
import org.junit.Before;
import org.junit.Test;

public class SampleByTest extends AbstractGriffinTest {
    @Before
    public void setUp3() {
        SharedRandom.RANDOM.set(new Rnd());
    }

    @Test
    public void testSampleFillNone() throws Exception {
        assertQuery("b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k from x sample by 3h fill(none)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillNull() throws Exception {
        assertQuery("b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k from x sample by 3h fill(null)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T18:00:00.000000Z\n" +
                        "\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-03T21:00:00.000000Z\n" +
                        "\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-04T00:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\tNaN\t1970-01-04T06:00:00.000000Z\n" +
                        "\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\tNaN\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillPrev() throws Exception {
        assertQuery("b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillPrevAllTypes() throws Exception {
        assertQuery("a\tb\tc\td\te\tf\tg\ti\tj\tl\tm\tp\tsum\tk\n" +
                        "1569490116\tfalse\tZ\tNaN\t0.7611\t428\t2015-05-16T20:27:48.158Z\tVTJW\t-8671107786057422727\t26\t00000000 68 61 26 af 19 c4 95 94 36 53 49\t1970-01-01T00:00:00.000000Z\t0.157866355996\t1970-01-03T00:00:00.000000Z\n" +
                        "-2132716300\ttrue\tU\t0.381797580478\tNaN\t813\t2015-07-01T22:08:50.655Z\tHYRX\t-6186964045554120476\t34\t00000000 07 42 fc 31 79 5f 8b 81 2b 93\t1970-01-01T01:00:00.000000Z\t0.041428124702\t1970-01-03T00:00:00.000000Z\n" +
                        "-360860352\ttrue\tM\t0.456344569609\tNaN\t1013\t2015-01-15T20:11:07.487Z\tHYRX\t5271904137583983788\t30\t00000000 82 89 2b 4d 5f f6 46 90 c3 b3 59 8e e5 61 2f 64\n" +
                        "00000010 0e 2c\t1970-01-01T02:00:00.000000Z\t0.675250954711\t1970-01-03T00:00:00.000000Z\n" +
                        "2060263242\tfalse\tL\tNaN\t0.3495\t869\t2015-05-15T18:43:06.827Z\tCPSW\t-5439556746612026472\t11\t\t1970-01-01T03:00:00.000000Z\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "502711083\tfalse\tH\t0.017185009856\t0.0977\t605\t2015-07-12T07:33:54.007Z\tVTJW\t-6187389706549636253\t32\t00000000 29 8e 29 5e 69 c6 eb ea c3 c9 73\t1970-01-01T04:00:00.000000Z\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "1569490116\tfalse\tZ\tNaN\t0.7611\t428\t2015-05-16T20:27:48.158Z\tVTJW\t-8671107786057422727\t26\t00000000 68 61 26 af 19 c4 95 94 36 53 49\t1970-01-01T00:00:00.000000Z\t0.157866355996\t1970-01-03T03:00:00.000000Z\n" +
                        "-2132716300\ttrue\tU\t0.381797580478\tNaN\t813\t2015-07-01T22:08:50.655Z\tHYRX\t-6186964045554120476\t34\t00000000 07 42 fc 31 79 5f 8b 81 2b 93\t1970-01-01T01:00:00.000000Z\t0.041428124702\t1970-01-03T03:00:00.000000Z\n" +
                        "-360860352\ttrue\tM\t0.456344569609\tNaN\t1013\t2015-01-15T20:11:07.487Z\tHYRX\t5271904137583983788\t30\t00000000 82 89 2b 4d 5f f6 46 90 c3 b3 59 8e e5 61 2f 64\n" +
                        "00000010 0e 2c\t1970-01-01T02:00:00.000000Z\t0.675250954711\t1970-01-03T03:00:00.000000Z\n" +
                        "2060263242\tfalse\tL\tNaN\t0.3495\t869\t2015-05-15T18:43:06.827Z\tCPSW\t-5439556746612026472\t11\t\t1970-01-01T03:00:00.000000Z\tNaN\t1970-01-03T03:00:00.000000Z\n" +
                        "502711083\tfalse\tH\t0.017185009856\t0.0977\t605\t2015-07-12T07:33:54.007Z\tVTJW\t-6187389706549636253\t32\t00000000 29 8e 29 5e 69 c6 eb ea c3 c9 73\t1970-01-01T04:00:00.000000Z\t0.226315234342\t1970-01-03T03:00:00.000000Z\n",
                "select a,b,c,d,e,f,g,i,j,l,m,p,sum(o), k from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_int() a," +
                        " rnd_boolean() b," +
                        " rnd_str(1,1,2) c," +
                        " rnd_double(2) d," +
                        " rnd_float(2) e," +
                        " rnd_short(10,1024) f," +
                        " rnd_date(to_date('2015', 'yyyy'), to_date('2016', 'yyyy'), 2) g," +
                        " rnd_symbol(4,4,4,2) i," +
                        " rnd_long() j," +
                        " rnd_byte(2,50) l," +
                        " rnd_bin(10, 20, 2) m," +
                        " rnd_str(5,16,2) n," +
                        " rnd_double(2) o," +
                        " timestamp_sequence(to_timestamp(0), 3600000000) p," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k) partition by NONE",
                "k",
                false
        );
    }

    @Test
    public void testSampleFillPrevDuplicateKey() throws Exception {
        assertQuery("b\tb1\tb2\tsum\tk\n" +
                        "\t\t\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t\t\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t\t\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "\t\t\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "\t\t\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\n" +
                        "\t\t\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\n" +
                        "\t\t\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\n",
                "select b, b, b, sum(a), k from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tb1\tb2\tsum\tk\n" +
                        "\t\t\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t\t\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t\t\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "\t\t\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "\t\t\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "\t\t\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "\t\t\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "\t\t\t86.089926708847\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "\t\t\t86.089926708847\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "\t\t\t54.491550215189\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t0.000000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "\t\t\t135.835983782176\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t0.000000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "\t\t\t135.835983782176\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\tVTJW\tVTJW\t48.820511018587\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\tRXGZ\tRXGZ\t23.905290108465\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\tPEHN\tPEHN\t49.005104498852\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\tHYRX\tHYRX\t12.026122412833\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\tUVSD\tUVSD\t49.428905119585\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\tKGHV\tKGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillPrevDuplicateTimestamp1() throws Exception {
        assertQuery("b\tsum\tk\tk1\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k, k from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk\tk1\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillPrevDuplicateTimestamp2() throws Exception {
        assertQuery("b\tsum\tk1\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k k1, k from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k1",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk1\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T00:00:00.000000Z\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T03:00:00.000000Z\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T06:00:00.000000Z\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T09:00:00.000000Z\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T12:00:00.000000Z\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T15:00:00.000000Z\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T18:00:00.000000Z\t1970-01-03T18:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-03T21:00:00.000000Z\t1970-01-03T21:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T00:00:00.000000Z\t1970-01-04T00:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\t0.000000000000\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T03:00:00.000000Z\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\t0.000000000000\t1970-01-04T06:00:00.000000Z\t1970-01-04T06:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\t1970-01-04T09:00:00.000000Z\n",
                false);
    }

    @Test
    public void testSampleFillPrevEmptyBase() throws Exception {
        assertQuery("a\tb\tc\td\te\tf\tg\ti\tj\tl\tm\tp\tsum\tk\n",
                "select a,b,c,d,e,f,g,i,j,l,m,p,sum(o), k from x where 0!=0 sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_int() a," +
                        " rnd_boolean() b," +
                        " rnd_str(1,1,2) c," +
                        " rnd_double(2) d," +
                        " rnd_float(2) e," +
                        " rnd_short(10,1024) f," +
                        " rnd_date(to_date('2015', 'yyyy'), to_date('2016', 'yyyy'), 2) g," +
                        " rnd_symbol(4,4,4,2) i," +
                        " rnd_long() j," +
                        " rnd_byte(2,50) l," +
                        " rnd_bin(10, 20, 2) m," +
                        " rnd_str(5,16,2) n," +
                        " rnd_double(2) o," +
                        " timestamp_sequence(to_timestamp(0), 3600000000) p," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k) partition by NONE",
                "k",
                false
        );
    }

    @Test
    public void testSampleFillPrevNoTimestamp() throws Exception {
        assertQuery("b\tsum\n" +
                        "\t11.427984775756\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t0.000000000000\n" +
                        "HYRX\t0.000000000000\n" +
                        "\t120.878116330711\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t70.943604871712\n" +
                        "HYRX\t0.000000000000\n" +
                        "\t57.934663268622\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t81.468079445006\n" +
                        "HYRX\t97.711031460512\n" +
                        "\t26.922103479745\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t81.468079445006\n" +
                        "HYRX\t12.026122412833\n" +
                        "\t150.486047954871\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t84.452581772111\n" +
                        "HYRX\t12.026122412833\n" +
                        "\t172.061250867250\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "\t86.089926708847\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n",
                "select b, sum(a) from x sample by 3h fill(prev)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                null,
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\n" +
                        "\t11.427984775756\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t0.000000000000\n" +
                        "HYRX\t0.000000000000\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t120.878116330711\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t70.943604871712\n" +
                        "HYRX\t0.000000000000\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t57.934663268622\n" +
                        "VTJW\t42.177688419694\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t81.468079445006\n" +
                        "HYRX\t97.711031460512\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t26.922103479745\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t81.468079445006\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t150.486047954871\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t84.452581772111\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t172.061250867250\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t86.089926708847\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t86.089926708847\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t86.089926708847\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t54.491550215189\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t0.000000000000\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t135.835983782176\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t49.428905119585\n" +
                        "KGHV\t0.000000000000\n" +
                        "\t135.835983782176\n" +
                        "VTJW\t48.820511018587\n" +
                        "RXGZ\t23.905290108465\n" +
                        "PEHN\t49.005104498852\n" +
                        "HYRX\t12.026122412833\n" +
                        "UVSD\t49.428905119585\n" +
                        "KGHV\t67.525095471124\n",
                false);
    }

    @Test
    public void testSampleFillValue() throws Exception {
        assertQuery("b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T18:00:00.000000Z\n",
                "select b, sum(a), k from x sample by 3h fill(20.56)",
                "create table x as " +
                        "(" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(172800000000), 3600000000) k" +
                        " from" +
                        " long_sequence(20)" +
                        ") timestamp(k) partition by NONE",
                "k",
                "insert into x select * from (" +
                        "select" +
                        " rnd_double(0)*100 a," +
                        " rnd_symbol(5,4,4,1) b," +
                        " timestamp_sequence(to_timestamp(277200000000), 3600000000) k" +
                        " from" +
                        " long_sequence(5)" +
                        ") timestamp(k)",
                "b\tsum\tk\n" +
                        "\t11.427984775756\t1970-01-03T00:00:00.000000Z\n" +
                        "VTJW\t42.177688419694\t1970-01-03T00:00:00.000000Z\n" +
                        "RXGZ\t23.905290108465\t1970-01-03T00:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T00:00:00.000000Z\n" +
                        "\t120.878116330711\t1970-01-03T03:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "PEHN\t70.943604871712\t1970-01-03T03:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T03:00:00.000000Z\n" +
                        "\t57.934663268622\t1970-01-03T06:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "PEHN\t81.468079445006\t1970-01-03T06:00:00.000000Z\n" +
                        "HYRX\t97.711031460512\t1970-01-03T06:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T06:00:00.000000Z\n" +
                        "\t26.922103479745\t1970-01-03T09:00:00.000000Z\n" +
                        "VTJW\t48.820511018587\t1970-01-03T09:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "HYRX\t12.026122412833\t1970-01-03T09:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T09:00:00.000000Z\n" +
                        "\t150.486047954871\t1970-01-03T12:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "PEHN\t84.452581772111\t1970-01-03T12:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T12:00:00.000000Z\n" +
                        "\t172.061250867250\t1970-01-03T15:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "PEHN\t49.005104498852\t1970-01-03T15:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T15:00:00.000000Z\n" +
                        "\t86.089926708847\t1970-01-03T18:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T18:00:00.000000Z\n" +
                        "\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-03T21:00:00.000000Z\n" +
                        "\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-04T00:00:00.000000Z\n" +
                        "\t54.491550215189\t1970-01-04T03:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-04T03:00:00.000000Z\n" +
                        "\t135.835983782176\t1970-01-04T06:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "UVSD\t49.428905119585\t1970-01-04T06:00:00.000000Z\n" +
                        "KGHV\t20.560000000000\t1970-01-04T06:00:00.000000Z\n" +
                        "\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "VTJW\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "RXGZ\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "PEHN\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "HYRX\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "UVSD\t20.560000000000\t1970-01-04T09:00:00.000000Z\n" +
                        "KGHV\t67.525095471124\t1970-01-04T09:00:00.000000Z\n",
                false);
    }
}
